## fopen() 函数的打开方式

不同的操作需要不同的文件权限。例如，只想读取文件中的数据的话，“只读”权限就够了；既想读取又想写入数据的话，“读写”权限就是必须的了。

另外，文件也有不同的类型，按照数据的存储方式可以分为二进制文件和文本文件，它们的操作细节是不同的。

在调用 fopen() 函数时，这些信息都必须提供，称为“文件打开方式”。最基本的文件打开方式有以下几种：

| 控制读写权限的字符串（必须指明） |                                                              |
| -------------------------------- | ------------------------------------------------------------ |
| 打开方式                         | 说明                                                         |
| "r"                              | 以“只读”方式打开文件。只允许读取，不允许写入。文件必须存在，否则打开失败。 |
| "w"                              | 以“写入”方式打开文件。如果文件不存在，那么创建一个新文件；如果文件存在，那么清空文件内容（相当于删除原文件，再创建一个新文件）。 |
| "a"                              | 以“追加”方式打开文件。如果文件不存在，那么创建一个新文件；如果文件存在，那么将写入的数据追加到文件的末尾（文件原有的内容保留）。 |
| "r+"                             | 以“读写”方式打开文件。既可以读取也可以写入，也就是随意更新文件。文件必须存在，否则打开失败。 |
| "w+"                             | 以“写入/更新”方式打开文件，相当于`w`和`r+`叠加的效果。既可以读取也可以写入，也就是随意更新文件。如果文件不存在，那么创建一个新文件；如果文件存在，那么清空文件内容（相当于删除原文件，再创建一个新文件）。 |
| "a+"                             | 以“追加/更新”方式打开文件，相当于a和r+叠加的效果。既可以读取也可以写入，也就是随意更新文件。如果文件不存在，那么创建一个新文件；如果文件存在，那么将写入的数据追加到文件的末尾（文件原有的内容保留）。 |

<table>
   <tr>
      <td colspan="2" align="center">控制读写方式的字符串（可以不写）</td>
   </tr>
   <tr>
      <td>打开方式</td>
      <td>说明</td>
   </tr>
   <tr>
      <td>"t"</td>
      <td>文本文件。如果不写，默认为"t"。</td>
   </tr>
   <tr>
      <td>"b"</td>
      <td>二进制文件。</td>
   </tr>
</table>

调用 fopen() 函数时必须指明读写权限，但是可以不指明读写方式（此时默认为 `t`）。

读写权限和读写方式可以组合使用，但是必须将读写方式放在读写权限的中间或者尾部（换句话说，不能将读写方式放在读写权限的开头）。例如：

- 将读写方式放在读写权限的末尾："rb"、"wt"、"ab"、"r+b"、"w+t"、"a+t"
- 将读写方式放在读写权限的中间："rb+"、"wt+"、"ab+"

整体来说，文件打开方式由 r、w、a、t、b、+ 六个字符拼成，各字符的含义是：

- r(read)：读
- w(write)：写
- a(append)：追加
- t(text)：文本文件
- b(banary)：二进制文件
- +：读和写

### gets() 和 fgets() 函数

`gets(char *str)` 函数从 `stdin` 读取输入到 str 指针指向的区域，直到读到一个换行符或 EOF 为止。

`fgets(char *str, int count, FILE *stream)` 最多从给定的 file stream 中读取 `count-1` 个 `characters` 存储到 str 中，遇到换行符或者 EOF 停止。

#### Return value

str on success,null pointer on failure

> ~~`gets()` 没有边界检查，是不安全，抛弃使用~~
> 在 C11 中已经移除了，推荐使用 `fgets()` 或 C11 中的 gets_s()